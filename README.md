<div align="center">

# STORM‚ÄëAI
**Satellite‚ÄØTracking‚ÄØand‚ÄØOrbit‚ÄØResilience‚ÄØModeling with‚ÄØAI**

![subtitle](https://raw.githubusercontent.com/ARCLab-MIT/STORM-AI-devkit-2025/refs/heads/main/docs/_img/subtitle.png)

[![License](https://img.shields.io/badge/License-MIT-921921.svg?logo=data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/Pgo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDIwMDEwOTA0Ly9FTiIKICJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy1TVkctMjAwMTA5MDQvRFREL3N2ZzEwLmR0ZCI+CjxzdmcgdmVyc2lvbj0iMS4wIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiB3aWR0aD0iMjI1LjAwMDAwMHB0IiBoZWlnaHQ9IjIyNS4wMDAwMDBwdCIgdmlld0JveD0iMCAwIDIyNS4wMDAwMDAgMjI1LjAwMDAwMCIKIHByZXNlcnZlQXNwZWN0UmF0aW89InhNaWRZTWlkIG1lZXQiPgoKPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsMjI1LjAwMDAwMCkgc2NhbGUoMC4xMDAwMDAsLTAuMTAwMDAwKSIKZmlsbD0iIzAwMDAwMCIgc3Ryb2tlPSJub25lIj4KPHBhdGggZD0iTTEwNjAgMjI0NCBjLTQwMyAtMzAgLTc0NyAtMjUxIC05MjQgLTU5NCAtOTMgLTE4MCAtMTI2IC0zMTggLTEyNgotNTI1IDAgLTE5NyAzMyAtMzQzIDExNCAtNTA0IDc0IC0xNDggMTkzIC0yOTIgMzI1IC0zOTIgODYgLTY1IDI4NCAtMTYxIDM4NwotMTg4IDIxMiAtNTUgNDc3IC00MyA2NzQgMzAgMzcxIDEzOCA2NDMgNDYwIDcxNiA4NDYgMjUgMTM3IDE2IDM4OCAtMjAgNTA4Ci0xMDkgMzY5IC0zODcgNjU3IC03NDEgNzY4IC0xMjEgMzcgLTI5MSA1OSAtNDA1IDUxeiBtLTUwMCAtMTExOSBsMCAtMzY1IC04MAowIC04MCAwIDAgMzY1IDAgMzY1IDgwIDAgODAgMCAwIC0zNjV6IG0yNjcgMTAwIGMyIC0xNDMgMSAtMjcwIC0yIC0yODIgLTUKLTIyIC0xMSAtMjMgLTg1IC0yMyBsLTgwIDAgMCAyODUgMCAyODYgODMgLTMgODIgLTMgMiAtMjYweiBtMjYzIC0xMDAgbDAKLTM2NSAtODUgMCAtODUgMCAwIDM2NSAwIDM2NSA4NSAwIDg1IDAgMCAtMzY1eiBtMjYwIDI4MCBsMCAtODYgLTgyIDMgLTgzIDMKLTMgODMgLTMgODIgODYgMCA4NSAwIDAgLTg1eiBtNTAwIDAgbDAgLTg1IC0xOTkgMCAtMTk4IDAgLTYgNjMgYy0xMSAxMTUgLTI1CjEwNyAyMDQgMTA3IGwxOTkgMCAwIC04NXogbS01MDAgLTQxMCBsMCAtMjM1IC04NSAwIC04NSAwIDAgMjM1IDAgMjM1IDg1IDAKODUgMCAwIC0yMzV6IG0yNjAgMCBsMCAtMjM1IC04MCAwIC04MCAwIC0yIDE5OCBjLTEgMTA4IC0yIDIxMSAtMyAyMjcgMCAxNyAxCjMzIDMgMzggMiA0IDM5IDcgODMgNyBsNzkgMCAwIC0yMzV6Ii8+CjwvZz4KPC9zdmc+Cg==&labelColor=FFFFFF)]()


</div>

---

<div align="center">
<a href="https://2025-ai-challenge.readthedocs.io/en/latest/dataset.html">Dataset</a> ‚Ä¢ 
<a href="https://2025-ai-challenge.readthedocs.io/en/latest/background.html">Background</a> ‚Ä¢ 
<a href="https://2025-ai-challenge.readthedocs.io/en/latest/faq.html">FAQ</a> 

---
<div style="display: flex; justify-content: center; align-items: center; gap: 10px; padding: 10px;">
  <div style="display: inline-flex; align-items: center; background-color: #4d4d4d; color: #ffffff; border-radius: 5px; padding: 5px 10px; font-family: Arial, sans-serif; font-size: 14px; text-align: center;">
      <a href="https://2025-ai-challenge.readthedocs.io/en/latest/README.html" target="_blank" style="color: #ffffff; text-decoration: none;">
        üìö Competition Docs
      </a>
  </div>

  <div style="display: inline-flex; align-items: center; background-color: #4d4d4d; color: #ffffff; border-radius: 5px; padding: 5px 10px; font-family: Arial, sans-serif; font-size: 14px; text-align: center;">
      <a href="https://arclab-mit.github.io" target="_blank" style="color: #ffffff; text-decoration: none;">
        üèÜ Leaderboard
      </a>
  </div>

  <div style="display: inline-flex; align-items: center; background-color: #4d4d4d; color: #ffffff; border-radius: 5px; padding: 5px 10px; font-family: Arial, sans-serif; font-size: 14px; text-align: center;">
      <img src="https://www.codabench.org/static/img/Cha_Logo.png" alt="Codabench Logo" style="height: 20px; margin-right: 8px;">
      <a href="https://www.codabench.org/competitions/5547/" target="_blank" style="color: #ffffff; text-decoration: none;">
      Codabench Competition
      </a>
  </div>

  <!-- <div style="display: inline-flex; align-items: center; background-color: #4d4d4d; color: #ffffff; border-radius: 5px; padding: 5px 10px; font-family: Arial, sans-serif; font-size: 14px; text-align: center; opacity: 0.5; cursor: not-allowed;">
      <img src="https://gist.githubusercontent.com/SSHurtado/ffd2219614f39158cff2a25d99644e08/raw/2dd8b8673032541c0d74eaf8230056fa57e2233f/arXive_icon.svg" alt="Article Icon" style="height: 20px; margin-right: 8px;"> 
      Article
  </div> -->
</div>

</div>

---





<div align="center">

<h3>Competition Overview </h3>

</div>

<div align="justify">

In 2024, solar storms have lit up the skies with stunning Auroras across the United States. But while these displays are captivating to observers on the ground, space weather has the potential to wreak havoc on our global satellite infrastructure. Geomagnetic storms cause rapid heating in Earth‚Äôs thermosphere, which can lead to more than a 10x increase in satellite drag in mere hours. In May 2024, the Gannon storm caused the largest mass migration of satellites in history and severely degraded satellite collision avoidance systems worldwide for multiple days ([Parker and Linares, 2024](https://arxiv.org/abs/2406.08617)). This challenge tackles the urgent need for more efficient and accurate tracking and orbit prediction capabilities for resident space objects in the increasingly crowded near-Earth environment. As space activities expand, the demand for advanced technologies to monitor and manage satellite behavior becomes paramount. 

The challenge objective is to develop cutting-edge AI algorithms for nowcasting and forecasting space weather-driven changes in atmospheric density across low earth orbit using historical space weather observations. The available phenomenology include solar and geomagnetic space weather indices, measurements of the interplanetary magnetic field, and measured solar wind parameters. Participants are provided with an existing empirical atmospheric density model and spacecraft accelerometer-derived in situ densities and are tasked with training or creating models to predict future atmospheric density values.
</div>

*Adapted from:*  [![arxiv](_img/arxiv_paper.svg)](https://arxiv.org/abs/2310.16912)


---

<div align="center">
<h3> Dataset </h3>
</div>

<div align="justify">

You can download the current version of the challenge dataset <a href="https://www.dropbox.com/scl/fo/5pq4kens2baw71p6pr1aq/AFD4xBI92ZN5CHy1cDlJp1E?rlkey=f95tcxwogoro8uel7fowm60x1&st=a091whhb&dl=0">here</a> and view our wiki page for more detailed information about the provided data and how to use it [here](https://2025-ai-challenge.readthedocs.io/en/latest/dataset.html).

The Satellite Tracking and Orbit Resilience Modeling with AI (STORM-AI) dataset contains a collection of historical orbital elements and satellite atmospheric densities, as well as information on magnetic field, plasma, indices, particles, X-Ray flux, and additional derived parameters. All training data is derived from public data sources distributed by organizations that are not affiliated with the AI Challenge, including the ESA, NASA Goddard Space Flight Center, and NOAA. 

The dataset consists of a public challenge dataset that can be used to train and develop AI algorithms and a private evaluation dataset of the same type and format. For valid submissions, algorithm inputs must be limited to the phenomenology and data formats present in the public training dataset, but utilizing additional phenomenology or data sources for model validation and development is allowed and encouraged.

</div>

## Quick‚Äëstart

### NOTE: existing `density_net.pt` is the same model file use in final competition entry
```bash
# 1 ‚îÄ Clone and enter the repo
git clone git@github.com:atillasaadat/stormai-mit-competition.git && cd stormai-mit-competition

# 2 ‚îÄ Create & activate a Python ‚â•3.10 virtual‚Äëenv
python -m venv .venv                    # Windows: py -m venv .venv
source .venv/bin/activate               # Windows: .\.venv\Scripts\activate

# 3 ‚îÄ Install deps
python -m pip install --upgrade pip
pip install -r requirements.txt

# 4 ‚îÄ Drop the dataset in ./data/ (see next section)

# 5 ‚îÄ Train a model (‚âà25‚ÄØmin on a modern GPU, ~2‚ÄØh on CPU)
python submission.py --mode train --epochs 50 --checkpoint density_net.pt 

# 6 ‚îÄ Predict on all files
python submission.py --mode predict --checkpoint density_net.pt
````

---

## Environment setup

| Requirement                | Notes                                                 |
| -------------------------- | ----------------------------------------------------- |
| **Python¬†‚â•‚ÄØ3.10**          | Tested on 3.10 &¬†3.11                                 |
| **PyTorch¬†‚â•‚ÄØ2.2**          | GPU automatically used if `torch.cuda.is_available()` |
| **See `requirements.txt`** | Full dependency list                                  |

<details>
<summary>Creating a fresh venv</summary>

```bash
# Unix / macOS
python -m venv .venv
source .venv/bin/activate

# Windows (PowerShell)
py -m venv .venv
.\.venv\Scripts\Activate.ps1
```

</details>

Deactivate any time with `deactivate`.

---

## Dataset preparation

1. **Download** the public challenge dataset from the competition site
   (direct link in the original README or from the Docs button above).
2. **Extract** so the folder tree looks like

```
STORM‚ÄëAI/
‚îú‚îÄ data/
‚îÇ  ‚îú‚îÄ omni2/            <‚Äë hourly & 3‚Äëhourly space‚Äëweather CSVs
‚îÇ  ‚îú‚îÄ sat_density/      <‚Äë orbit‚Äëmean‚Äëdensity ground truth
‚îÇ  ‚îî‚îÄ initial_state/    <‚Äë initial Keplerian / geodetic elements
‚îÇ       ‚îî‚îÄ initial_states.csv
‚îî‚îÄ submission.py
```

You can override these paths at runtime by editing `Config` in `submission.py` **or** by passing absolute directories with `--omni2_folder` etc. (see `--help`).

---

## Script entry‚Äëpoints

The entire workflow lives in `submission.py`.

### Training

```bash
python submission.py --mode train \
    --checkpoint density_net.pt    \        # where to save best weights
    --epochs 50                    \        # override defaults if desired
    --patience 24                  \        # early‚Äëstop patience (epochs)
    --subset_pct 0.1                         # (optional) train on 10‚ÄØ% of data
```

*Output:* `density_net.pt` containing model weights **plus** the fitted feature & label scalers.

### Prediction / inference

```bash
python submission.py --mode predict --checkpoint density_net.pt
```

*Creates `prediction.json`* in the submission format accepted by Codabench.

**Extras**

```bash
# Plot truth vs. prediction for a single file ID
python submission.py --mode predict --checkpoint density_net.pt --plot 00042

# Speed up JSON writes on large sets (writes in chunks of 100)
python submission.py --mode predict --chunk 100
```

---

## Input tensors & folder layout

| Stream                | Shape fed to network | Description                                                                  |
| --------------------- | -------------------- | ---------------------------------------------------------------------------- |
| **Historical OMNI‚Äë2** | `(T=1440, F‚âà200)`    | 60¬†days of 1‚ÄØh /‚ÄØ3‚ÄØh aggregates + explicit lags on 11 solar / geomag indices |
| **Static features**   | `(1440,¬†13)`         | 6 Keplerian‚ÅÑgeodetic values + cyclic encodings (lon,¬†DOY,¬†sidereal time)     |
| **œÅ‚ÇÄ normaliser**     | `(1440,¬†1)`          | File‚Äëlevel mean density prior to stabilise logs                              |

All features are concatenated horizontally (total **`F=TOTAL_FEATURES=220`**) and scaled with a `QuantileTransformer` to a unit‚ÄëGaussian.

---

## Model at a glance

```
History ‚Üí Bi‚ÄëGRU (3‚ÄØlayers, hidden=384, dropout=0.3, bidirectional)
        ‚Üí Additive Attention Pool (learned temporal weights)
        ‚Üí LayerNorm ‚Üí GELU MLP head ‚Üí 432‚Äëstep forecast
```

*Loss*¬†¬†Time‚Äëweighted MSE (earlier horizons weighted higher, mirroring the competition metric).

*Latency*¬†‚âà‚ÄØ0.5‚ÄØms/sample on an RTX¬†3090 Ti; <2‚ÄØms on a fast CPU.

---

## Folder reference

```
‚îú‚îÄ submission.py      End‚Äëto‚Äëend train / predict CLI
‚îú‚îÄ datahandler.py     Light CSV I/O fa√ßade
‚îú‚îÄ README.md          ‚Üê you are here
‚îî‚îÄ requirements.txt   Reproducible dependency list
```

---
<div align="center">
<h3> Development Toolkit </h3>
</div>

<div align="justify">

The STORM-AI DevKit is accessible on GitHub <a href="https://github.com/ARCLab-MIT/STORM-AI-devkit-2025/">here</a>. It includes the code for the baseline model that appears on the Competition leaderboard, a high-fidelity orbit propagator, and more. 

The development kit is coded in Python and includes a set of essential utility functions, tutorials, and baseline implementations designed to help participants get started with the challenge. The tutorials provide guidance on data reading, parsing, and manipulation, as well as on training, evaluating, and submitting the machine learning algorithms to the competition platform.
</div>


---

<div align="center">
<h3>Competition Acknowledgements</h3>
</div>

<div align="center">
<i>Research was sponsored by the Department of the Air Force Artificial Intelligence Accelerator and was accomplished under Cooperative Agreement Number FA8750-19-2-1000. The views and conclusions contained in this document are those of the authors and should not be interpreted as representing the official policies, either expressed or implied, of the Department of the Air Force or the U.S. Government. The U.S. Government is authorized to reproduce and distribute reprints for Government purposes notwithstanding any copyright notation herein.

¬© 2024 Massachusetts Institute of Technology.</i>
</div>

---